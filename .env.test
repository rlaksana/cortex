# =============================================================================
# TEST ENVIRONMENT CONFIGURATION - QDRANT ONLY
# =============================================================================
# This configuration uses Qdrant vector database for testing
# PostgreSQL is NO LONGER SUPPORTED

# =============================================================================
# MANDATORY: OPENAI API KEY FOR TESTING
# =============================================================================
OPENAI_API_KEY=test-key-for-testing-only

# =============================================================================
# QDRANT VECTOR DATABASE CONFIGURATION
# =============================================================================
QDRANT_URL=http://localhost:6333
QDRANT_COLLECTION_NAME=cortex-test-memory
QDRANT_TIMEOUT=30000

# =============================================================================
# VECTOR EMBEDDING CONFIGURATION FOR TESTING
# =============================================================================
VECTOR_SIZE=1536  # 1536=text-embedding-3-small, 3072=*-3-large
VECTOR_DISTANCE=Cosine
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_BATCH_SIZE=5

# =============================================================================
# SEARCH CONFIGURATION FOR TESTING
# =============================================================================
SEARCH_LIMIT=20
SEARCH_MODE=auto
ENABLE_CACHE=false
CACHE_TTL=300
SIMILARITY_THRESHOLD=0.7

# =============================================================================
# TEST ENVIRONMENT SETTINGS
# =============================================================================
NODE_ENV=test
LOG_LEVEL=debug
MCP_TEST_MODE=true
MCP_TEST_TIMEOUT=30000
MCP_LOG_LEVEL=debug

# =============================================================================
# TESTING INFRASTRUCTURE CONFIGURATION
# =============================================================================
TEST_DATABASE_CLEANUP=true
TEST_ISOLATION=true
TEST_PARALLEL_WORKERS=4
MOCK_EXTERNAL_SERVICES=true
GENERATE_TEST_DATA=true
CLEANUP_AFTER_TESTS=true

# =============================================================================
# COVERAGE AND REPORTING CONFIGURATION
# =============================================================================
COVERAGE_ENABLED=true
COVERAGE_THRESHOLD=80
GENERATE_REPORTS=true
REPORTS_DIR=./artifacts/test-reports
ARTIFACTS_DIR=./artifacts/mcp-tests

# =============================================================================
# PERFORMANCE SETTINGS FOR TESTING
# =============================================================================
DB_MAX_CONNECTIONS=5
DB_CONNECTION_TIMEOUT=10000
API_TIMEOUT=15000
RETRY_ATTEMPTS=2

# =============================================================================
# EMFILE PREVENTION SETTINGS - AUTO-GENERATED
# Added by setup-test-environment.ps1 on 2025-10-30
# =============================================================================

# Node.js handle limit optimizations
EMFILE_HANDLES_LIMIT=131072
UV_THREADPOOL_SIZE=16
NODE_OPTIONS=--max-old-space-size=4096 --max-semi-space-size=256 --optimize-for-size --expose-gc

# Test performance optimizations
TEST_TIMEOUT=30000
TEST_WORKERS=4
NODE_MAX_SEMI_SPACE_SIZE=256
NODE_MAX_OLD_SPACE_SIZE=4096

# Windows-specific test settings
FORCE_COLOR=1
NO_COLOR=0
DEBUG=test:*

# =============================================================================
# SECURITY SETTINGS FOR TESTING
# =============================================================================
JWT_SECRET=test_jwt_secret_key_32_chars_minimum
ENCRYPTION_KEY=test_encryption_key_32_chars_hex

# =============================================================================
# TEST SCOPE SETTINGS
# =============================================================================
CORTEX_ORG=test-org
CORTEX_PROJECT=test-project
CORTEX_BRANCH=test

# =============================================================================
# Z.AI CONFIGURATION FOR TESTING
# =============================================================================
ZAI_API_KEY=test-zai-key-for-testing-only
ZAI_BASE_URL=https://api.z.ai/api/anthropic
ZAI_MODEL=glm-4.6
ZAI_TIMEOUT=30000
ZAI_MAX_RETRIES=3
ZAI_RETRY_DELAY=1000
ZAI_CIRCUIT_BREAKER_THRESHOLD=3
ZAI_CIRCUIT_BREAKER_TIMEOUT=60000
ZAI_ENABLE_LOGGING=false
ZAI_RATE_LIMIT_RPM=60

# Z.AI AI Orchestrator Configuration
ZAI_PRIMARY_PROVIDER=zai
ZAI_FALLBACK_PROVIDER=openai
ZAI_AUTO_FAILOVER=true
ZAI_HEALTH_CHECK_INTERVAL=30000
ZAI_FALLBACK_THRESHOLD=3

# Z.AI Background Processor Configuration
ZAI_MAX_CONCURRENCY=5
ZAI_QUEUE_SIZE=100
ZAI_RETRY_ATTEMPTS=3
ZAI_RETRY_DELAY_MS=1000
ZAI_TIMEOUT_MS=30000
ZAI_ENABLE_PRIORITY_QUEUE=false
ZAI_PERSIST_JOBS=false
ZAI_METRICS_INTERVAL=60000

# Z.AI Circuit Breaker Configuration
ZAI_CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
ZAI_CIRCUIT_BREAKER_TIMEOUT=120000
ZAI_CIRCUIT_BREAKER_MONITORING_PERIOD=10000
ZAI_CIRCUIT_BREAKER_EXPECTED_RECOVERY_TIME=30000

# Z.AI Request Queue Configuration
ZAI_QUEUE_MAX_SIZE=500
ZAI_QUEUE_CONCURRENCY=4
ZAI_QUEUE_TIMEOUT_MS=25000
ZAI_QUEUE_RETRY_ATTEMPTS=2
ZAI_QUEUE_RETRY_DELAY_MS=500
ZAI_QUEUE_PRIORITY=false

# =============================================================================
# MCP SERVER CONFIGURATION FOR TESTING
# =============================================================================
MCP_SERVER_NAME=cortex-test
MCP_SERVER_VERSION=2.0.0-test
MCP_TRANSPORT=stdio
MCP_MAX_BATCH_SIZE=10

# =============================================================================
# CONFIGURATION NOTES
# =============================================================================
# ❌ REMOVED: All PostgreSQL configuration and dependencies
# ✅ SIMPLIFIED: Only Qdrant vector database required for testing
# ✅ CONSISTENT: Same database backend as production (Qdrant)
# =============================================================================
